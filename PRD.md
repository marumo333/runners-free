```md
## 目的 / 背景
- フリーランスや個人事業主が **自身のECサイト構築のハードル** を感じずに、Web上でビジネスを完結できるプラットフォームを提供。
- 信頼担保の **審査機能**、**電子決済**、**配送／電子配布** の一連フローをワンストップで実装し、手数料モデルで収益化。

## ユーザー
- **フリーランス（デザイナー、ライター、エンジニアなど）**
- **個人事業主**
- **エンド顧客**（法人・個人）

## 課題
1. 自力でECサイトを構築するためのコスト・技術的ハードル
2. 決済・配送フローの設定の煩雑さ
3. 初回顧客への信頼獲得（取引安全性）の確保

## 解決策
- **フリーランス限定プラットフォーム**：審査機能で信頼性を担保
- **Stripe連携**：簡易なクレジットカード決済
- **配送ラベル／電子配布**：APIで配送業者連携またはDLリンク発行
- **レビュー機能**：購入後レビューで実績可視化

## 機能要件
| 機能                 | 概要                                |
|----------------------|-------------------------------------|
| 会員認証             | 顧客／出品者別のログイン・登録      |
| 役割判定・ルーティング | ログイン後、自動的に「顧客用画面」または「出品者用ダッシュボード」へリダイレクト |
| フリーランス審査     | 身分証＋ポートフォリオ提出 → 手動承認 |
| 商品管理             | 出品（タイトル・説明・価格・画像）／編集／削除 |
| 購入フロー           | カート／数量変更／購入手続き        |
| 決済連携             | Stripe Checkout API                |
| 注文履歴             | 顧客側・出品者側で一覧・詳細表示    |
| レビュー             | 購入後のみ星評価＋コメント投稿・表示 |

## 非機能要件

- **レスポンス**：主要APIレスポンスタイム2秒以内
- **可用性**：99.9% uptime を目指す（Vercel/Supabase利用）
- **セキュリティ**：HTTPS必須、Stripe推奨ガイドに準拠
- **スケーラビリティ**：無料プランから段階的アップグレード可能
- **アクセシビリティ**：モバイル・タブレット対応（レスポンシブ）

## KPI
- **登録フリーランス数**：PoC期間中に50名
- **出品数**：200件以上
- **購入件数**：100件以上
- **コンバージョン率**：閲覧→購入 2%以上
- **レビュー投稿率**：購入後20%以上

## 画面設計（概要）
1. **会員登録／ログイン**
2. **審査申請フォーム**
3. **ダッシュボード**
   - フリーランス：審査状況、出品管理
   - 顧客：注文履歴、レビュー管理
4. **商品一覧／詳細**
5. **カート／購入手続き**
6. **レビュー投稿画面**

## 機能仕様
以下では、主要機能ごとに**UI／画面要件**と**API 要件**をまとめています。

### 1. 会員認証・役割判定
- **UI**:
  - 会員登録画面：メール／パスワード／役割選択（フリーランス or 顧客）
  - ログイン画面：メール／パスワード入力
  - ログイン後：ロールに応じたダッシュボードへリダイレクト
- **バリデーション**:
  - メール形式チェック
  - パスワード強度（8文字以上、大文字・数字を推奨）
- **API**:
  | 機能           | エンドポイント                | メソッド | 説明                          |
  |---------------|------------------------------|----------|-------------------------------|
  | 会員登録       | `/api/auth/register`         | POST     | role, email, password 登録    |
  | ログイン       | `/api/auth/login`            | POST     | JWT 発行                      |

### 2. フリーランス審査申請
- **UI**:
  - 審査申請ページ：身分証アップロード（ドラッグ＆ドロップ対応）、ポートフォリオURL入力欄、申請ボタン
  - 申請状況表示：「審査中／承認／却下」をマイページに表示
- **バリデーション**:
  - 画像形式チェック（PNG, JPEG）
  - URL形式チェック
- **API**:
  | 機能       | エンドポイント                 | メソッド | 説明                                      |
  |------------|-------------------------------|----------|-------------------------------------------|
  | 審査申請   | `/api/review/apply`            | POST     | 身分証画像, portfolioUrl を送信            |
  | 審査状況    | `/api/review/status`           | GET      | ログインユーザーの審査ステータス取得      |

### 3. 商品管理（出品／編集／削除）
- **UI**:
  - 出品画面：タイトル／説明／価格／カテゴリ選択／画像アップロード(プレビュー表示)
  - 編集画面：既存データのフォーム表示＋保存ボタン
  - 商品一覧（マイページ）：編集・削除ボタン表示
- **バリデーション**:
  - タイトル必須、100文字以内
  - 価格：正の整数
  - 画像：1～5枚まで
- **API**:
  | 機能       | エンドポイント                 | メソッド | 説明                                      |
  |------------|-------------------------------|----------|-------------------------------------------|
  | 出品       | `/api/products`               | POST     | title, price, images[], category 保存    |
  | 編集       | `/api/products/:id`           | PUT      | 商品データ更新                           |
  | 削除       | `/api/products/:id`           | DELETE   | 商品削除                                 |

### 4. 購入フロー／カート
- **UI**:
  - カートアイコン：バッジで件数表示
  - カートページ：商品一覧、数量変更、削除、合計金額
  - 購入手続き画面：配送先入力フォーム／「支払いへ」ボタン
- **バリデーション**:
  - 数量：1以上
  - 配送情報必須項目（住所、氏名、電話番号）
- **API**:
  | 機能       | エンドポイント                 | メソッド | 説明                                      |
  |------------|-------------------------------|----------|-------------------------------------------|
  | カート取得 | `/api/cart`                    | GET      | ログインユーザーのカート情報取得         |
  | カート更新 | `/api/cart`                    | PUT      | 顧客ID, 商品ID, 数量を更新               |

### 5. 決済連携
- **UI**:
  - 支払い情報入力画面：Stripe Checkout ボタン
  - 決済成功・失敗時のフィードバック画面
- **API**:
  | 機能       | エンドポイント                 | メソッド | 説明                                      |
  |------------|-------------------------------|----------|-------------------------------------------|
  | 決済開始   | `/api/checkout/create`        | POST     | カート情報で Stripe セッション作成      |
  | 決済Webhook| `/api/checkout/webhook`       | POST     | Stripe イベント受信 & 注文確定処理     |

### 6. 注文履歴
- **UI**:
  - 顧客用：購入履歴一覧、各注文詳細
  - 出品者用：自分の商品売上一覧、顧客情報確認
- **API**:
  | 機能           | エンドポイント               | メソッド | 説明                                  |
  |----------------|-----------------------------|----------|---------------------------------------|
  | 注文履歴取得   | `/api/orders`               | GET      | ログインユーザーの注文履歴取得       |
  | 注文詳細取得   | `/api/orders/:id`           | GET      | 個別注文情報取得                     |

### 7. レビュー機能
- **UI**:
  - 注文履歴画面から「レビューを書く」ボタン
  - レビューフォーム：星評価／コメント入力
  - 商品詳細ページにレビュー一覧表示
- **バリデーション**:
  - 星評価必須
  - コメント：10～500文字
- **API**:
  | 機能       | エンドポイント               | メソッド | 説明                                  |
  |------------|-----------------------------|----------|---------------------------------------|
  | レビュー投稿| `/api/reviews`              | POST     | orderId, rating, comment を投稿      |
  | レビュー一覧| `/api/products/:id/reviews` | GET      | 商品ごとのレビュー取得               |

## 工程（スプリントプラン）（スプリントプラン）
| Sprint | 期間        | 主なタスク                                        |
|--------|-------------|---------------------------------------------------|
| 1      | 1週目       | 認証・審査機能、DB設計                            |
| 2      | 2週目       | 商品管理（出品・編集・削除）、ダッシュボード実装  |
| 3      | 3週目       | カート・決済フロー、注文履歴                      |
| 4      | 4週目       | レビュー機能、E2Eテスト、デプロイ                |
```
